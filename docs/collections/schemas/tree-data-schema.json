{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://geogram.example.com/schemas/tree-data.json",
  "title": "Geogram Collection Tree Data Schema",
  "description": "JSON Schema for Geogram tree-data.js file index",
  "type": "array",
  "items": {
    "oneOf": [
      {
        "title": "File Entry",
        "type": "object",
        "required": ["path", "name", "type", "size", "mimeType", "hashes"],
        "properties": {
          "path": {
            "type": "string",
            "description": "Full path from collection root",
            "minLength": 1
          },
          "name": {
            "type": "string",
            "description": "File name",
            "minLength": 1
          },
          "type": {
            "type": "string",
            "const": "file"
          },
          "size": {
            "type": "integer",
            "description": "File size in bytes",
            "minimum": 0
          },
          "mimeType": {
            "type": "string",
            "description": "MIME type",
            "pattern": "^[a-z0-9][a-z0-9\\-]*\\/[a-z0-9][a-z0-9\\-\\+\\.]*$"
          },
          "hashes": {
            "type": "object",
            "required": ["sha1"],
            "properties": {
              "sha1": {
                "type": "string",
                "description": "SHA1 hash (hex)",
                "pattern": "^[a-f0-9]{40}$"
              }
            }
          },
          "metadata": {
            "type": "object",
            "properties": {
              "mime_type": {
                "type": "string"
              },
              "description": {
                "type": "string"
              },
              "views": {
                "type": "integer",
                "minimum": 0
              }
            }
          }
        }
      },
      {
        "title": "Directory Entry",
        "type": "object",
        "required": ["path", "name", "type"],
        "properties": {
          "path": {
            "type": "string",
            "description": "Full path from collection root",
            "minLength": 1
          },
          "name": {
            "type": "string",
            "description": "Directory name",
            "minLength": 1
          },
          "type": {
            "type": "string",
            "const": "directory"
          }
        }
      }
    ]
  }
}
